Snipe-IT offers a CSV import tool that will let you import users right from the GUI, however if you have another automation that for some reason populates a Google Sheet, you can use this script to import users from a Google Sheet.

## Important!

These scripts are *by design* data destructive. Please always make sure you [run a backup](https://snipe-it.readme.io/docs/backups) by going to `Admin Settings > Backups` before running them. That way if something gets messed up, you can easily restore to a known good point.

## Sheet Format

This script expects a CSV that has a header row (though it doesn't matter what the header names are) with column order matching the order in the table below.

| Column Order | Column     | Description            | Required | Unique |
|--------------|------------|------------------------|----------|--------|
| 1            | First Name | First name of the user | Yes      | No     |
| 2            | Last Name  | Last name of the user  | No       | No     |
| 3            | Email      | User's email           | No       | No     |
| 4            | Username   | User's username        | Yes      | Yes    |
| 5            | Password   | User's password        | Yes      | No     |
| 6            | Notes      | Notes on this user     | No       | No     |
| 7            | Status     | Leave this empty       |          |        |

<img width="1668" alt="Screenshot 2023-12-18 at 5 54 33 PM" src="https://github.com/grokability/google-apps-scripts-for-snipe-it/assets/197404/d9d93be5-392f-4047-8d39-aa4b0fa6028a">

Passwords will automatically be hashed in the database. 

Validation errors will show up in the Status column:

<img width="1319" alt="Screenshot 2023-12-18 at 5 47 52 PM" src="https://github.com/grokability/google-apps-scripts-for-snipe-it/assets/197404/b564b883-ab95-44ea-a9a6-9510dca4aab6">

## Using this Script

You will need to update:


| Script Variable    | Description|
|--------------------| ---|
| `api_baseurl`      | This should be the base URL of your own Snipe-IT instance. It will usually look something like 'https://your-url/api/v1'. There should not be a trailing flash at the end of the URL, and it should start with `http://` or `https://`.|
| `api_bearer_token` | This will be the [API Bearer token](https://snipe-it.readme.io/reference/generating-api-tokens) generated by the user you want to take these actions on behalf of. Make sure the token value starts with `Bearer ` (include that space between the API key generated by Snipe-IT.) If you have trouble authenticating, [see this additional information](https://snipe-it.readme.io/reference/authenticating-with-the-api).|

### Result

<img width="702" alt="Screenshot 2023-12-12 at 10 07 09 PM" src="https://gist.github.com/assets/197404/533dbf17-6383-43c0-80ed-7895fc00dfa2">